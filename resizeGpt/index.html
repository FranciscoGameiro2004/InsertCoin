<!DOCTYPE html>
<html>
<head>
  <title>Exemplo de Image Map com Destaque</title>
  <style>
    .point {
                position: absolute;
                width: 10px;
                height: 10px;
                background-color: red;
                border-radius: 50%;
                transform: translate(-50%, -50%);
            }
  </style>
</head>
<body style="position: relative;">
  <img id="gameScreen" src="https://placehold.co/500x400" alt="Imagem" usemap="#imagemap" style="z-index: -1;width: 1000px;">
  <!--<img id="gameScreen" src="/alvo.png" alt="Imagem" usemap="#imagemap" style="z-index: -1;">-->
  <div id="pointContainer"></div>
  <map id="view1" name="imagemap">
    <!--<area shape="rect" coords="0,0,100,100" href="link1.html" alt="Área 1"> 2 Pontos-->
    <!--<area shape="circle" coords="150,150,10" href="link2.html" alt="Área 2">3 Pontos-->
    <area shape="poly" coords="250,200" href="link3.html" alt="Área 3">
  </map>

  <script>

window.addEventListener('load', function() {
      // Obtém a imagem e o mapa
      var imagem = document.getElementById('gameScreen');
      var mapa = document.querySelector('map');

      // Função para redimensionar o mapa
      function resizeMap() 
      {
        console.log(imagem.naturalWidth)
        console.log(imagem.naturalHeight)

        var widthRatio = imagem.clientWidth / imagem.naturalWidth;
        var heightRatio = imagem.clientHeight / imagem.naturalHeight;

        // Redimensiona as coordenadas de cada área do mapa
        var areas = mapa.getElementsByTagName('area');
        for (var i = 0; i < areas.length; i++) {
          var coords = areas[i].getAttribute('coords').split(',');
          for (var j = 0; j < coords.length; j++) {
            coords[j] = Math.round(parseInt(coords[j]) * widthRatio);
            console.log("-----")
            console.log(coords[j]);
          }
          areas[i].setAttribute('coords', coords.join(','));
        }
        console.log(`widthRatio:${widthRatio}||heightRatio:${heightRatio}`)
        console.log(coords)
      }

      // Redimensiona o mapa quando a imagem for carregada e quando a janela for redimensionada
      imagem.addEventListener('load', resizeMap);
      window.addEventListener('resize', resizeMap);

      // Redimensiona o mapa pela primeira vez
      resizeMap();
    });

//Function to create points on the game screen image
function createPoints() 
{
    // Get the game screen image element
    const gameScreen = document.getElementById("gameScreen");

    // Get the image map element
    const view1 = document.getElementById("view1");

    // Get the areas (image maps) within the image map
    const areas = view1.getElementsByTagName("area");

    // Get the point container element
    const pointContainer = document.getElementById("pointContainer");

    const timeBar = 0

    // Loop through the areas and create points for each coordinate
    for (let i = 0; i < areas.length; i++) 
    {
        console.log("ciclo " + i)
        const area = areas[i];
        let coords = area.getAttribute("coords").split(",");
        //console.log(coords.length)
        let cordsLength = coords.length/2

        for (let j = 0; j < cordsLength; j++)
        {
            /*
            console.log("-----------------------------------------")
            console.log("-------------cilco:" + j + "-------------")
            console.log("-----------------------------------------")
            console.log(coords)
            */
            let newCoordsPoints = coords.splice(0,2)
            //console.log(coords)
            //console.log(newCoordsPoints)
            const point = document.createElement("div");

            // Set the position and style of the point
            point.className = "point";
            point.style.left = newCoordsPoints[0] + "px";
            let newCoord = stringToInt(newCoordsPoints[1]) + timeBar;
            //console.log(newCoord)
            newCoordsPoints[1] = intToString(newCoord);
            point.style.top = newCoordsPoints[1] + "px";

            // Add the point to the point container
            pointContainer.appendChild(point);
        }

    
    }
}

// Call the createPoints function when the page has finished loading
window.addEventListener("load", createPoints);

function stringToInt(str) 
{
return parseInt(str, 10);
}

function intToString(num) 
{
return num.toString();
}
  </script>

</body>
</html>